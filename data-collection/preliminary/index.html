
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Templates and bootstrapping documentation for MRI standard operating procedures (SOPs)">
      
      
        <meta name="author" content="The AxonLab">
      
      
      
        <link rel="prev" href="../../recruitment-scheduling-screening/scheduling/">
      
      
        <link rel="next" href="../pre-session/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.5">
    
    
      
        <title>Preliminary work - Standard Operating Procedures of the HCPh project</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0e669242.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--thanks:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M313.4 32.9c26 5.2 42.9 30.5 37.7 56.5l-2.3 11.4c-5.3 26.7-15.1 52.1-28.8 75.2h144c26.5 0 48 21.5 48 48 0 18.5-10.5 34.6-25.9 42.6C497 275.4 504 288.9 504 304c0 23.4-16.8 42.9-38.9 47.1 4.4 7.3 6.9 15.8 6.9 24.9 0 21.3-13.9 39.4-33.1 45.6.7 3.3 1.1 6.8 1.1 10.4 0 26.5-21.5 48-48 48h-97.5c-19 0-37.5-5.6-53.3-16.1l-38.5-25.7C176 420.4 160 390.4 160 358.3V247.1c0-29.2 13.3-56.7 36-75l7.4-5.9c26.5-21.2 44.6-51 51.2-84.2l2.3-11.4c5.2-26 30.5-42.9 56.5-37.7zM32 192h64c17.7 0 32 14.3 32 32v224c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32V224c0-17.7 14.3-32 32-32z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overall-experimental-setting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Standard Operating Procedures of the HCPh project" class="md-header__button md-logo" aria-label="Standard Operating Procedures of the HCPh project" data-md-component="logo">
      
  <img src="../../assets/images/chuv_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Standard Operating Procedures of the HCPh project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Preliminary work
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Standard Operating Procedures of the HCPh project" class="md-nav__button md-logo" aria-label="Standard Operating Procedures of the HCPh project" data-md-component="logo">
      
  <img src="../../assets/images/chuv_logo.svg" alt="logo">

    </a>
    Standard Operating Procedures of the HCPh project
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../changes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change History
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Recruitment, Scheduling, and Screening
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Recruitment, Scheduling, and Screening
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../recruitment-scheduling-screening/recruitment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recruitment and screening
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../recruitment-scheduling-screening/scheduling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scheduling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data collection
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Data collection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Preliminary work
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Preliminary work
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overall-experimental-setting" class="md-nav__link">
    Overall experimental setting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#once-at-the-beginning-of-the-project" class="md-nav__link">
    Once, at the beginning of the project
  </a>
  
    <nav class="md-nav" aria-label="Once, at the beginning of the project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-up-the-scanner-protocol-at-the-mr-console" class="md-nav__link">
    Setting up the scanner protocol at the MR console
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-biopac" class="md-nav__link">
    Install the BIOPAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-gas-analyzer-ga" class="md-nav__link">
    Install the gas analyzer (GA)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preparing-the-stimuli-presentation-laptop" class="md-nav__link">
    Preparing the Stimuli presentation laptop (███)
  </a>
  
    <nav class="md-nav" aria-label="Preparing the Stimuli presentation laptop (███)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stimuli-presentation-with-psychopy" class="md-nav__link">
    Stimuli presentation with psychopy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-eyelink-eye-tracker-software" class="md-nav__link">
    Installing EyeLink (eye tracker software)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-a-synchronization-service" class="md-nav__link">
    Setting up a synchronization service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#every-two-months" class="md-nav__link">
    Every two months
  </a>
  
    <nav class="md-nav" aria-label="Every two months">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calibrate-the-ga" class="md-nav__link">
    Calibrate the GA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../pre-session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Before each session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../participant-prep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preparing the participant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../scanning-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notes on the scanner's console and recording devices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../scanning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running the scanning session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tear-down/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session tear-down
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../emergency-procedures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Emergency procedures
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data management
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Data management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../data-management/post-session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Post-session retrieval and BIDS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../data-management/mriqc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QC of unprocessed data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../release/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release of data
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overall-experimental-setting" class="md-nav__link">
    Overall experimental setting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#once-at-the-beginning-of-the-project" class="md-nav__link">
    Once, at the beginning of the project
  </a>
  
    <nav class="md-nav" aria-label="Once, at the beginning of the project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-up-the-scanner-protocol-at-the-mr-console" class="md-nav__link">
    Setting up the scanner protocol at the MR console
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-biopac" class="md-nav__link">
    Install the BIOPAC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-gas-analyzer-ga" class="md-nav__link">
    Install the gas analyzer (GA)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preparing-the-stimuli-presentation-laptop" class="md-nav__link">
    Preparing the Stimuli presentation laptop (███)
  </a>
  
    <nav class="md-nav" aria-label="Preparing the Stimuli presentation laptop (███)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stimuli-presentation-with-psychopy" class="md-nav__link">
    Stimuli presentation with psychopy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-eyelink-eye-tracker-software" class="md-nav__link">
    Installing EyeLink (eye tracker software)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-a-synchronization-service" class="md-nav__link">
    Setting up a synchronization service
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#every-two-months" class="md-nav__link">
    Every two months
  </a>
  
    <nav class="md-nav" aria-label="Every two months">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calibrate-the-ga" class="md-nav__link">
    Calibrate the GA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset"><a class="md-content__button md-icon" download href="../../pdf/documentation.pdf" title="PDF Export"><svg style="height: 1.2rem; width: 1.2rem;" viewBox="0 0 384 512" xmlns="http://www.w3.org/2000/svg"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"></path></svg></a>
                
                  


  <h1>Preliminary work</h1>

<h2 id="overall-experimental-setting">Overall experimental setting<a class="headerlink" href="#overall-experimental-setting" title="Permanent link">&para;</a></h2>
<p>The goal of the experimental setting is to obtain several functional MRI tasks and a long diffusion MRI scan with synchronized physiological recordings, including gas contents with a gas analyzer (GA), eye tracking (ET; including the right eye position, pupil size, blinks, etc.), respiration tracking through a pneumatic respiration belt (RB), and finally MRI-compatible electrocardiogram (ECG).</p>
<p>The overall experimental setting can be sumarized as follows:</p>
<pre class="mermaid"><code>flowchart TB

    subgraph "Scanning Room"
        direction TB
        sr1[Scanner]
        sr2[Cannula]
        sr3[RB]
        sr4[ECG]
        sr5[ET]
    end

    subgraph "BIOPAC"
        direction TB
        biopac1[DA100C]
        biopac2[ECG100C MRI]
        biopac3[AMI100D]
        biopac4[STP100D]
    end

    sr1 ---&gt;|Trigger| sb[Syncbox]
    sr2 ---&gt; ga[Gas Analyzer]
    sr3 ---&gt;|"Negative (-)"| biopac1[DA100C]
    sr4 ---&gt; biopac2[ECG100C MRI]
    sr5 ---&gt; et[Eye Tracker PC]

    ga ---&gt;|"Channel 3 (CO&lt;sub&gt;2&lt;/sub&gt;)"| biopac3
    ga ---&gt;|"Channel 4 (O&lt;sub&gt;2&lt;/sub&gt;)"| biopac3

    sb ---&gt;|USB| pc1["Stimuli presentation Laptop (███)"]
    pc1 &lt;---&gt;|Ethernet| et
    pc1 ---&gt;|USB| modem[MMBT-S Interface]
    pc1 ---&gt;|HDMI| display[Projector]
    modem ---&gt;|25-pin parallel| biopac4

    BIOPAC ---&gt;|Ethernet| pc2["Physio-recording Laptop (███)"]</code></pre>
<p>The above graph can be broken down as follows:</p>
<ol>
<li><strong>Signals generating from the Scanning Room</strong>.
    In addition to the MR imagery produced by the scanner, the participant will be wearing the RB, the ECG leads, a nasal cannula to retrieve the expired gases, and finally their right eye will be recorded with the infrared camera of the ET.
    All those probes and devices carry signals outside the Scanning Room either through cables or tubes, with the access panel as the interface.
    The access panel also has a connector carrying the <strong>trigger</strong> signals generated by MR schemes, which indicate important events in the MRI acquisition (typically, one trigger pulse is generated for each new <em>repetition time</em> —TR—, e.g., with every fMRI volume).</li>
<li><strong>Syncbox</strong>.
    A <em>NordicLabs Syncbox</em> receives TTL (transistor-transistor logic) triggers from the scanner.
    This box can just forward the triggers converted into other formats and/or manipulate them (e.g., filter, generate, etc.).</li>
<li><strong>Gas analyzer (GA)</strong>.
    The GA is a device that continuously measures the amount of two gases (CO<sub>2</sub> and O<sub>2</sub>) from a sample fed at the front of the device with a connected tube (this tube comes from inside of the Scanning Room and ends in the nasal cannula the participant is wearing, as shown in the graph).</li>
<li>
<p><strong>BIOPAC</strong>.
    The BIOPAC is the main recording hub.
    It directly receives analogical signals from the Scanning Room (for the case of the RB and the ECG).
    Indirectly, it receives the analogical signal from the GA, and digital signals from the <em>Psychopy laptop</em> (███).</p>
</li>
<li>
<p><strong>Eye tracker (ET)</strong>.
    The ET is composed of two main elements:
    (i) inside the scanner's bore, we place an arm that holds an infrared lens and camera sensor on one side and an infrared lamp that illuminates the right eye of the subject through a special mirror to reflect the infrared spectrum; and (ii) a PC tower that receives the camera recordings, postprocess the images and calculates the final parameters of interest (position of the eye, pupil size, etc.).
    The ET is also connected to the <em>Psychopy laptop</em> (███), and communicates bi-directionally with it (e.g., to record logs or receive "messages" such as triggers or task events).
    The ET <strong>is NOT connected to the BIOPAC</strong>, with the implication that the ET data is not stored with the other physiological information.</p>
</li>
<li><strong>Stimuli presentation laptop</strong>.
    The <em>Psychopy laptop</em> (███) has the <em>Psychopy</em> software install and with it, the task programs are executed.
    This experiment consists of three tasks: breath-holding task (<em>BHT</em>), resting-state fMRI (<em>rest</em>), and a positive-control task (<em>PCT</em>).
    This laptop also stores the data recorded by the ET at the end of the experiment.</li>
<li><strong>Physiology recording laptop</strong>.
    The <em>AcqKnowledge laptop</em> (███) runs the BIOPAC's <em>AcqKnowledge</em> software and with it, this computer records the signals and allows visualization of the data coming from the BIOPAC.
    All the inputs to the BIOPAC are multiplexed through into an Ethernet cable that is connected to this laptop.</li>
</ol>
<h2 id="once-at-the-beginning-of-the-project">Once, at the beginning of the project<a class="headerlink" href="#once-at-the-beginning-of-the-project" title="Permanent link">&para;</a></h2>
<h3 id="setting-up-the-scanner-protocol-at-the-mr-console">Setting up the scanner protocol at the MR console<a class="headerlink" href="#setting-up-the-scanner-protocol-at-the-mr-console" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">Emergency procedures</p>
<p>It is critical you fully understand and study the <a href="../emergency-procedures/">emergency procedures to run an MRI scan at CHUV</a>.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Follow Reproin conventions</p>
<p>When assigning names to the MR sequences in the protocol, make sure to follow the <a href="https://dbic-handbook.readthedocs.io/en/latest/mri/reproin.html">Reproin conventions</a> to maximally facilitate the conversion into BIDS.</p>
</div>
<p>Once the protocol is decided upon, and after any updates, make sure of storing the protocol.</p>
<div class="admonition warning">
<p class="admonition-title">Login as an advanced user to save protocol</p>
<p>As a good practice, always work as the standard user <code>janedoe</code>.
Change for <em>advanced user mode</em> if you want to save the protocol.</p>
<ul class="task-list">
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Simultaneously press the <span class="keypress">Tab</span> + <span class="keypress">Delete</span> + <span class="keypress"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2 2.75C2 1.784 2.784 1 3.75 1h2.5a.75.75 0 0 1 0 1.5h-2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h2.5a.75.75 0 0 1 0 1.5h-2.5A1.75 1.75 0 0 1 2 13.25Zm10.44 4.5-1.97-1.97a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l3.25 3.25a.75.75 0 0 1 0 1.06l-3.25 3.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.97-1.97H6.75a.75.75 0 0 1 0-1.5Z"/></svg></span></span> on the control-computer's keyboard:</p>
<blockquote>
<p>Username: <code>superjanedoe</code></p>
<p>Password: <code>******</code></p>
</blockquote>
</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">After three wrong password entries, access will be denied, and only a Siemens engineer will be able to unlock the MR scanner.</p>
</div>
</div>
<ul class="task-list">
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Update the <em>Number of measurements</em> in all <code>func-bold_task-*</code> sequences, according to the <a href="#task-timing">previously recorded timings</a>:</p>
<div class="arithmatex">\[N_\text{measurements} = L_t / \text{TR}, \quad t \in \{\text{bht}, \text{pct}, \text{rest}\},\]</div>
<p>where <span class="arithmatex">\(L_t\)</span> is the length of a particular task <span class="arithmatex">\(t\)</span> (either BHT, PCT, or resting state) in seconds as timed before, and
<span class="arithmatex">\(\text{TR}\)</span> is the <strong>repetition time</strong> of the BOLD sequence, in seconds.</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Now that you are logged in as an advanced user, save your protocol:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Open the Dot-Cockpit window
    <img alt="" src="../../assets/images/save_protocol1.jpg" /></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> In <code>Browse</code>, find the right folder to save the protocol in (<em>RESEARCH</em> ⤷ <em>Oscar</em>).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Right click on the folder and select <em>New</em> ⤷ <em>Program</em>. This opens an empty page in the program editor
    <img alt="" src="../../assets/images/save_protocol2.jpg" />
    <img alt="" src="../../assets/images/save_protocol3.jpg" /></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Select all the sequences you want to run from the sequence list and click right to copy.
    <img alt="" src="../../assets/images/save_protocol4.jpg" /></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Drag or paste the copied sequences in the program editor.
    <img alt="" src="../../assets/images/save_protocol5.jpg" /></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Once finished, click on the floppy disk icon (<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7c-12-12-28.3-18.7-45.3-18.7H64zm0 96c0-17.7 14.3-32 32-32h192c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32v-64zm160 160a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg></span>) in the upper left to save.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Give the protocol a relevant name starting with the date of acquisition in the format YYYYMMDD and click <span class="consolebutton">Save</span>.
    <img alt="" src="../../assets/images/save_protocol6.jpg" /></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> If desired, the protocol details can also be downloaded as a pdf on a peripherical USB key.<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Right-click on the protocol and select <em>Print</em></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Save the PDF in your USB key.</li>
</ul>
</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Make sure you save a different protocol for each of the four PE directions (i.e., AP, PA, LR, RL).</li>
</ul>
<h3 id="install-the-biopac">Install the BIOPAC<a class="headerlink" href="#install-the-biopac" title="Permanent link">&para;</a></h3>
<div class="admonition important">
<p class="admonition-title">BIOPAC documentation</p>
<p>Get familiar with the BIOPAC setup and read through the <a href="https://www.biopac.com/wp-content/uploads/MP_Hardware_Guide.pdf">hardware documentation</a></p>
</div>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Set up the line frequency switches on the back of the BIOPAC amplifier depending on your country frequency to reduce noise. Both switches should be DOWN if your country's line frequency is 50Hz. Both switches should be UP if your country's line frequency line is 60Hz.
    <img alt="biopack-frequency-switch" src="../../assets/images/biopack-frequency-switch.jpg" title="BIOPAC frequency switch" /></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Plug the different units of the BIOPAC together if it has not been done yet.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Get familiar with the BIOPAC system:<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> We use the BIOPAC to synchronize and output in a single file all the physiological recordings: cardiac pulsation, respiration and CO<sub>2</sub>  concentration.
<img alt="Biopac_setup" src="../../assets/images/Biopac_setup.jpg" title="BIOPAC front side" /></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> The AMI100C unit can receive up to 16 analog signals.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> The DA100C unit records the signal coming from the respiration belt. Plug the TSD160A unit on the DA100C.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> The ECG100C MRI unit records the electrical signal coming from the heart via the ECG. Plug the MECMRI-2 unit on the ECG100C unit.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> The <a href="../../assets/files/STP100D.pdf">SPT100D (solid state relay driver unit)</a> is used to input digital signals that must be recorded (e.g., the trigger signals from the scanner)</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Ensure that the <em>Mode</em> switch of the <a href="../../assets/files/MMBT-S_instruction_manual_v2.2.pdf">MMBT-S Trigger Interface Box adapter (pink color box)</a> is set on the <strong>P</strong> position.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Install the BIOPAC recording software (<em>AcqKnowledge</em>).</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Create a template <em>graph file</em> (<a href="../../assets/files/EXP_BASE.gtl"><code>EXP_BASE.gtl</code></a>)</p>
<div class="admonition important">
<p class="admonition-title">Creating the <em>AcqKnowledge</em>'s template graph file</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Creating a graph file requires the BIOPAC system powered up and connected to the <em>███</em> computer.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Add the RB module<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Check the channel on top switch of the unit: the <mark>DA100C</mark> MUST be set on <strong>channel 1</strong>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Under the tab <em>Analog</em>, click on <em>Add new module</em>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Find the name of the BIOPAC unit corresponding to the <mark>DA100C</mark>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Set the module settings (gain, filters, etc.) corresponding to those of the configuration switches in the front of the module.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> When prompted to enter the calibration points, map the interval [-5, 0] to [0, 10]. You invert the sign of the interval for the interpretation to be more clear.</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Add the ECG module<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Check the channel on top switch of the unit: the <mark>ECG100C MRI</mark> MUST be set on <strong>channel 2</strong>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Under the tab <em>Analog</em>, click on <em>Add new module</em>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Find the name of the BIOPAC unit corresponding to the <mark>ECG100C</mark>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Set the module settings (gain, filters, etc.) corresponding to those of the configuration switches in the front of the module.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> When prompted to enter [calibration?], for the ECG you should map the interval ?? to ??.</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Add the GA module<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Confirm that the CO<sub>2</sub> output of the GA is connected through the ANISO filter to the <strong>channel 3</strong> of the AMI100C module.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Under the tab <em>Analog</em>, click on <em>Add new module</em>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Select <em>Custom</em> and then indicate it is connected to <strong>channel 3</strong> by selecting <em>AMI/HLT - in3</em>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> When prompted to enter the calibration points, map the interval [0.03, 1.0] to [0, 10.0].</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Add the Digital inputs<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Under the tab <em>Digital</em>, click on <em>Add new module</em>.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> The parallel cable feeds into ports <mark>D8-D15</mark>.</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Configure the sampling frequency</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Configure the experiment length (at least 2.5 hours)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Configure whether you want to collect directly to hard disk and autosave settings</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Save the experiment, making sure you choose a "graph template file" (with extension <code>.gtl</code>)</li>
</ul>
</div>
</li>
</ul>
<h3 id="install-the-gas-analyzer-ga">Install the gas analyzer (GA)<a class="headerlink" href="#install-the-gas-analyzer-ga" title="Permanent link">&para;</a></h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Get familiar with the <a href="../../assets/files/GA_manual.pdf">GA's manual</a> and watch the following video:
    <video id="wistia_simple_video_119" crossorigin="anonymous" style="background: transparent; display: block; height: 100%; max-height: none; max-width: none; position: static; visibility: visible; width: 100%; object-fit: fill;" aria-label="Video" src="https://embed-ssl.wistia.com/deliveries/5e08ccab25ab45382329671a82dfe5123f6e840e/file.mp4" playsinline="" preload="metadata" type="video/mp4" x-webkit-airplay="allow" controls>
      <source src="https://embed-ssl.wistia.com/deliveries/5e08ccab25ab45382329671a82dfe5123f6e840e/file.mp4" type="video/mp4" />
      Your browser does not support the video. <a href="./assets/files/GA_video.mp4">Click here to download it</a>
    </video></li>
</ul>
<h3 id="preparing-the-stimuli-presentation-laptop">Preparing the <em>Stimuli presentation laptop</em> (███)<a class="headerlink" href="#preparing-the-stimuli-presentation-laptop" title="Permanent link">&para;</a></h3>
<p>This block describes how to prepare a laptop with a running <em>Psychopy 3</em> installation, the <em>EyeLink</em> software corresponding to the Eye Tracker, and finally an <em>Experiment synchronization service</em>.</p>
<h4 id="stimuli-presentation-with-psychopy">Stimuli presentation with <em>psychopy</em><a class="headerlink" href="#stimuli-presentation-with-psychopy" title="Permanent link">&para;</a></h4>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> <a href="https://github.com/TheAxonLab/HCPh-fMRI-tasks/fork">Fork the HCPh-fMRI-tasks repository</a> under your user on GitHub.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Clone the <a href="https://github.com/TheAxonLab/HCPh-fMRI-tasks">HCPh-fMRI-tasks repository</a>:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>git clone git@github.com:&lt;your-gh-username&gt;/HCPh-fMRI-tasks.git
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Set-up the original repository as upstream remote:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>git remote add upstream git@github.com:theaxonlab/HCPh-fMRI-tasks.git
</span></code></pre></div></li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Log on <em>███</em> with the username <em>███</em> and password <em>███</em>.</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Clone the <a href="https://github.com/psychopy/psychopy.git">PsychoPy repository</a>:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>git clone git@github.com:psychopy/psychopy.git
</span></code></pre></div></p>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Navigate to the Psychopy directory:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>cd psychopy
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Psychopy should not be installed with anaconda. If an anaconda environment is activated, run the following command to deactivate it:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>conda deactivate
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Update pip to the latest version:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>pip3 install --upgrade pip
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Install bdist_mpkg, py2app and attrdict:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>pip3 attrdict py2app bdist_mpkg
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Install Psychopy using the following command:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>pip3 install -e .
</span></code></pre></div></li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Open Psychopy, open the experiment-files corresponding to each task:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> <code>task-rest_bold.psyexp</code> (resting-state fMRI):<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> time it to confirm the length, and</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> check that the movie is played.</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> <code>task-bht_bold.psyexp</code> (breath-holding task, BHT):<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> time it to confirm the length, and</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> check that the movie is played.</li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> <code>task-pct_bold.psyexp</code> (positive-control task, PCT) :<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> time it to confirm the length, and</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> check that the movie is played.</li>
</ul>
</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Remember to time the three functional MRI runs (rest, qct, bht)</p>
<p><a name="task-timing"></a>
The lengths of the three runs should be:</p>
<ul>
<li><code>task-bht_bold.psyexp</code> ➜ <mark><strong>5min 41s</strong></mark>,</li>
<li><code>task-rest_bold.psyexp</code> ➜ <mark><strong>20min 0s</strong></mark>, and</li>
<li><code>task-pct_bold.psyexp</code> ➜ <mark><strong>2min 38s</strong></mark>.</li>
</ul>
</div>
</li>
</ul>
<h4 id="installing-eyelink-eye-tracker-software">Installing <em>EyeLink</em> (eye tracker software)<a class="headerlink" href="#installing-eyelink-eye-tracker-software" title="Permanent link">&para;</a></h4>
<ul class="task-list">
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Log on <em>███</em> with the username <em>███</em> and password <em>███</em>.</p>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Enable Canonical's universe repository with the following command:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>sudo add-apt-repository universe
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>sudo apt update
</span></code></pre></div></p>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Install and update the ca-certificates package:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>sudo apt update
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>sudo apt install ca-certificates
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Add the SR Research Software Repository signing key:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>sudo apt-key adv --fetch-keys https://apt.sr-research.com/SRResearch_key
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Install the EyeLink Developers Kit:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>sudo apt install eyelink-display-software
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Install the EyeLink Data Viewer:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>sudo apt install eyelink-dataviewer
</span></code></pre></div></li>
</ul>
<h4 id="setting-up-a-synchronization-service">Setting up a synchronization service<a class="headerlink" href="#setting-up-a-synchronization-service" title="Permanent link">&para;</a></h4>
<div class="admonition important">
<p class="admonition-title">It's fundamental to have a reliable means of communication with the BIOPAC digital inputs</p>
<p>The following guidelines set up a little service on a linux box that keeps listening for key presses (mainly, the <span class="keypress">s</span> trigger from the trigger box), and RPC (remote procedure calls) from typically <em>Psychopy</em> or similar software.</p>
<p>The service is spun up automatically when you connect the MMBT-S modem interface that communicates with the BIOPAC (that is, the <em>N-shaped pink box</em>)</p>
</div>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Copy the <a href="https://github.com/TheAxonLab/hcph-sops/blob/mkdocs/code/synchronization/forward-trigger-service.py">latest version of the code to send triggers</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> To automatically start the program when the BIOPAC is connected, create a udev rule as follows:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>sudo nano /etc/udev/rules.d/99-forward-trigger.rules
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Add the following rule to the file:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>ACTION==&quot;add&quot;, KERNEL==&quot;ttyACM0&quot;, SUBSYSTEM==&quot;tty&quot;, TAG+=&quot;systemd&quot;, ENV{SYSTEMD_WANTS}=&quot;forward-trigger.service&quot;
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Save the file and exit the editor.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Run the following command to reload the udev rules:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>sudo udevadm control --reload-rules
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Create a systemd service unit file:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>sudo nano /etc/systemd/system/forward-trigger.service
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Add the following content to the file (Adapt the path to forward-trigger.py to the location on your computer):
    <div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>[Unit]
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>Description=Forward Trigger Service
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>After=network.target
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>[Service]
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>ExecStart=/usr/bin/python3 /path/to/forward-trigger.py
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>WorkingDirectory=/path/to/forward-trigger/directory
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>StandardOutput=null
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>[Install]
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>WantedBy=multi-user.target
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Save the file and exit the text editor.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Run the following command to enable the service to start at boot:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>sudo systemctl enable forward-trigger
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Run the following command to reload the systemd daemon:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>sudo systemctl daemon-reload
</span></code></pre></div></li>
</ul>
<details class="important">
<summary>Testing the service without the syncbox connected</summary>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Ensure <code>socat</code> and <code>screen</code> are installed (if not already):
      <div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>sudo apt-get update
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>sudo apt-get install socat screen
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Create a virtual serial port and establish a symbolic link to <code>/dev/ttyACM0</code> using the following command:
      <div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>sudo socat PTY,link=/tmp/virtual_serial_port PTY,link=/dev/ttyACM0,group-late=dialout,mode=666,b9600
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> With <code>screen</code>, listen to the new virtual serial port:
      <div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>screen /dev/ttyACM0
</span></code></pre></div></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Press <span class="keypress">s</span> and verify that <code>^A</code> appears in the screen terminal.</li>
</ul>
</details>
<h2 id="every-two-months">Every two months<a class="headerlink" href="#every-two-months" title="Permanent link">&para;</a></h2>
<h3 id="calibrate-the-ga">Calibrate the GA<a class="headerlink" href="#calibrate-the-ga" title="Permanent link">&para;</a></h3>
<details class="important">
<summary>A gas mixture bottle with a known CO<sub>2</sub> and O<sub>2</sub> concentrations is necessary</summary>
<p>CO<sub>2</sub> concentration must be between 5% and 10%, while O<sub>2</sub> within 5% and 21%.
A second reference mixture is necessary, and room air can be used, knowing that atmospheric contents by volume are 0.039 ±0.001%
for CO<sub>2</sub> and 20.946 ±0.003% for O<sub>2</sub>.</p>
</details>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Connect the GA to the BIOPAC as described above.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Connect the BIOPAC to the <em>Physiology recording laptop</em> (███) as described above.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Connect the <em>AcqKnowledge</em> License Key into a USB Port of the <em>Physiology recording laptop</em> (███).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Open <em>AcqKnowledge</em> software on the <em>Physiology recording laptop</em> (███).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Open the template <em>graph file</em> (<a href="../../assets/files/EXP_BASE.gtl"><code>EXP_BASE.gtl</code></a>)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Edit the configuration of the inputs 3 (connected to the CO<sub>2</sub> output of the GA) and 4 (connected to the O<sub>2</sub> output of the GA).
    Lower and upper calibration points can be set by sampling the input a number of times with the <em>AcqKnowledge</em> utility.</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox"/><span class="task-list-indicator"></span></label> Overwrite the template <em>graph file</em> <code>EXP_BASE.gtl</code>.</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.expand", "navigation.top", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.78eede0e.min.js"></script>
      
        <script src="../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>